#!/usr/bin/env bash

image_tag="biopod/amber:22.22"
echo "Starting ${image_tag} container in current dir..."

# --cap-add=SYS_PTRACE for fixing mpi error in docker container running on some machine
# error looks like: [730d2d54ede3:01733] Read -1, expected 5352, errno = 1
# discussed at here: https://github.com/open-mpi/ompi/issues/4948
docker run --ipc=shareable --cap-add=SYS_PTRACE --rm -it --gpus all \
           --mount type=bind,source=$(realpath $(pwd)),target=/mnt \
           --user $(id -u):$(id -g) \
           ${image_tag}
